---
title: 'ID Modeling Final Project: Cholera'
author: "Alicia Yang (ay2452), Ashley Tseng (at3346), Cassandra Coulter (cc4347), and Christopher Armbruster (cwa2118)"
date: "Due: May 6, 2020"
output: html_document
---

```{r setup, include=FALSE}
##setting up file
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(deSolve)
```

```{r}
###Building SIWR model from Tuite et al. 2011

SIWR = function(t,state,parameters){
  with(as.list(c(state,parameters)),{
    
    dS = (-lambda*S) - (S);
    dI = (-gamma*I) + (lambda*S) - (I);
    dR = (gamma*R) - (R);
    dW = (xi*(I-W))/N 
    
    list(c(dS,dI,dR, dW))
  })
}



##NOTE: initial conditions/parameters not completely edited yet

# Specify initial conditions/parameters
times_SIWR = seq(0, 730, by = 1);  # run for a year
N = 9798046; # population size
W0 = 0.0003; #initial concentration of bacteria
W = 2.3; #concentration of bacteria
I0 = 0; #initial no. of infectious individuals
S0 = N - I0;  # initial No. of Susceptible people
R0 = 0; # initial No. of Recovered people
Beta_x = 0.010; #transmission rate from case
Beta_w = 0.944; #transmissibility of water
gamma = 1/2.913; #gamma
xi = 1/5.910; #mean survivial of pathogen in water (weeks)
state_SIWR = c( S = S0, I = I0, W = W0, R = R0)
parameters_SIWR = c(gamma, xi, lambda)
lambda = (Beta_x*I + Beta_w*W)/N; #force of infection
sim_SIWR = ode(y = state_SIWR, times = times_SIWR, func = SIWR, parms = parameters_SIWR)

##force of infection
lambda = (Beta_x*I + Beta_w*W)/N


##R0
R_0 = 2.78
R0_eq = Beta_w/gamma
```

